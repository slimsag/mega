.. _config_http_input:

HTTP Input
==========

Plugin Name: **HttpInput**

HttpInput plugins intermittently poll remote HTTP URLs for data and populate
message objects based on the results of the HTTP interactions. Messages will
be populated as follows:

- Uuid: Type 4 (random) UUID generated by Heka.
- Timestamp: Time HTTP request is completed.
- Type: `heka.httpinput.data` or `heka.httpinput.error` depending on whether or
        not the request completed. (Note that a response returned with an HTTP
        error code is still considered complete and will generate type
        `heka.httpinput.data`.)

- Hostname: Hostname of the machine on which Heka is running.
- Payload: Entire contents of the HTTP response body.
- Severity: HTTP response 200 uses `success_severity` config value, all other
            results use `error_severity` config value.
- Logger: Fetched URL.
- Fields["Status"] (string): HTTP status string value (e.g. "200 OK").
- Fields["StatusCode"] (int): HTTP status code integer value.
- Fields["ResponseSize"] (int): Value of HTTP Content-Length header.
- Fields["ResponseTime"] (float64): Clock time elapsed for HTTP request, in
                                    seconds.
- Fields["Protocol"] (string): HTTP protocol used for the request (e.g.
                               "HTTP/1.0")

The `Fields` values above will only be populated in the event of a completed
HTTP request. Also, it is possible to specify a decoder to further process the
results of the HTTP response before injecting the message into the router.

Config:

- url (string):
    A HTTP URL which this plugin will regularly poll for data. This option
    cannot be used with the urls option. No default URL is specified.
- urls (array):
    .. versionadded:: 0.5

    An array of HTTP URLs which this plugin will regularly poll for data. This
    option cannot be used with the url option. No default URLs are specified.
- method (string):
    .. versionadded:: 0.5

    The HTTP method to use for the request. Defaults to "GET".
- headers (subsection):
    .. versionadded:: 0.5

    Subsection defining headers for the request. By default the User-Agent
    header is set to "Heka"
- body (string):
    .. versionadded:: 0.5

    The request body (e.g. for an HTTP POST request). No default body is
    specified.
- username (string):
    .. versionadded:: 0.5

    The username for HTTP Basic Authentication. No default username is
    specified.
- password (string):
    .. versionadded:: 0.5

    The password for HTTP Basic Authentication. No default password is
    specified.
- ticker_interval (uint):
    Time interval (in seconds) between attempts to poll for new data. Defaults
    to 10.
- success_severity (uint):
    .. versionadded:: 0.5

    Severity level of successful HTTP request. Defaults to 6 (information).
- error_severity (uint):
    .. versionadded:: 0.5

    Severity level of errors, unreachable connections, and non-200 responses
    of successful HTTP requests. Defaults to 1 (alert).

Example:

.. code-block:: ini

    [HttpInput]
    url = "http://localhost:9876/"
    ticker_interval = 5
    success_severity = 6
    error_severity = 1
    decoder = "MyCustomJsonDecoder"
        [HttpInput.headers]
        user-agent = "MyCustomUserAgent"
