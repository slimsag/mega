.. _config_whisper_output:

Whisper Output
==============

Plugin Name: **WhisperOutput**

WhisperOutput plugins parse the "statmetric" messages generated by a
StatAccumulator and write the extracted counter, timer, and gauge data out to
a `graphite <http://graphite.wikidot.com/>`_ compatible `whisper database
<http://graphite.wikidot.com/whisper>`_ file tree structure.

Config:

- base_path (string):
    Path to the base directory where the whisper file tree will be written.
    Absolute paths will be honored, relative paths will be calculated relative
    to the Heka base directory. Defaults to "whisper" (i.e.
    "$(BASE_DIR)/whisper").
- default_agg_method (int):
    Default aggregation method to use for each whisper output file. Supports
    the following values:

    0. Unknown aggregation method.
    1. Aggregate using averaging. (default)
    2. Aggregate using summation.
    3. Aggregate using last received value.
    4. Aggregate using maximum value.
    5. Aggregate using minimum value.
- default_archive_info ([][]int):
    Default specification for new whisper db archives. Should be a sequence of
    3-tuples, where each tuple describes a time interval's storage policy:
    [<offset> <# of secs per datapoint> <# of datapoints>] (see `whisper docs
    <graphite.readthedocs.org/en/latest/whisper.html>`_ for more info). Defaults
    to:

    .. code-block:: ini

        [ [0, 60, 1440], [0, 900, 8], [0, 3600, 168], [0, 43200, 1456]]

    The above defines four archive sections. The first uses 60 seconds for
    each of 1440 data points, which equals one day of retention. The second
    uses 15 minutes for each of 8 data points, for two hours of retention. The
    third uses one hour for each of 168 data points, or 7 days of retention.
    Finally, the fourth uses 12 hours for each of 1456 data points,
    representing two years of data.
- folder_perm (string):
    Permission mask to be applied to folders created in the whisper database
    file tree. Must be a string representation of an octal integer. Defaults
    to "700".

Example:

.. code-block:: ini

    [WhisperOutput]
    message_matcher = "Type == 'heka.statmetric'"
    default_agg_method = 3
    default_archive_info = [ [0, 30, 1440], [0, 900, 192], [0, 3600, 168], [0, 43200, 1456] ]
    folder_perm = "755"
